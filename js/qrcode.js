!function(){function o(o){var e=o.replace("-","_"),n={};return n[e+"_option_type"]=$("#"+o+"-option-type").val(),n[e+"_option_color"]=$("#"+o+"-option-color").val(),n}function e(o,e){return{color:o[e+"_option_color"],type:o[e+"_option_type"]}}function n(o,e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(o)}function r(o,e){if(o instanceof File)return n(o,e);if(t[o])return e(t[o]);var r=new XMLHttpRequest;r.onload=function(){2===Math.floor(r.status/100)?n(r.response,function(n){e(t[o]=n)}):e(null)},r.open("GET","https://corsproxy.io/?"+encodeURIComponent(o)),r.responseType="blob",r.send()}function i(o,n){var r=o.type,i="svg"===r?"svg":"canvas",t=o.image?"H":"Q",a={width:o.size,height:o.size,type:i,data:o.input,image:o.image,imageOptions:{imageSize:o.image_size||.4,margin:o.image_margin||0,hideBackgroundDots:!o.image_show_background},dotsOptions:e(o,"dot"),cornersSquareOptions:e(o,"corners_square"),cornersDotOptions:e(o,"corners_dot"),qrOptions:{errorCorrectionLevel:t},backgroundOptions:{color:o.background_option_color}},c=document.getElementById("qrcode");new QRCodeStyling(a).getRawData(r).then(function(o){var e=new FileReader;e.onload=function(o){c.innerHTML='<img src="'+o.target.result+'"/>',n&&n(o.target.result,r)},e.readAsDataURL(o)}).catch(function(o){console.log(o),n(null)})}var t={};if(window.fetchQuery=function(){for(var o={},e=location.search.substring(1),n=e.split("&"),r=0;r<n.length;++r){var i=n[r].split("=");o[i[0]]=decodeURIComponent(i[1])}return o},window.generateByQuery=function(o,e){o.image?r(o.image,function(n){o.image=n,i(o,e)}):i(o,e)},window.$){var a=$("#qrcode"),c=$("#image-type"),l=$("#image"),s=$("#qr-droppable-zone"),d=$(".share-block"),u=$("#download-image"),g=a.html();window.generate=function(e){var n=c.val(),r="file"===n?$("#image-file")[0].files[0]:l.val(),i=$("#size").val(),t=Object.assign({input:e,type:$("#type").val(),size:i,image:r,image_size:$("#image-size").val(),image_margin:$("#image-margin").val(),image_show_background:$("#image-show-background").prop("checked"),background_option_color:$("#background-option-color").val()},o("dot"),o("corners-square"),o("corners-dot"));generateByQuery(t,function(o,e){o?(u.attr("download","qrcode."+e).attr("href",o),u.show()):(a.html(g),u.hide())});var s=$("#share-link").val().replace("/qrcode.html?","/qrcode_embed.html?");return $("#qrcode-link").val(s),'<iframe src="'+s+'" frameborder="0" scrolling="no" width="'+i+'" height="'+i+'"></iframe>'},$(window).on("methodLoad",function(){c.change(function(){"url"===c.val()?(l.show(),s.hide(),d.show()):(l.hide(),s.show(),d.hide())}),c.change(),$(".color-input").each(function(){var o,e=$(this).find("input"),n=$(this).find(".color");n.css("background-color",e.val()),e.bind("change",function(){n.css("background-color",e.val()),o&&(o.color.setColor(e.val()),o.render())}),n.colorPicker({doRender:!1,buildCallback:function(){o=this},renderCallback:function(o,r){n.css("background-color",o._css.backgroundColor),!1===r&&(e.val(o._css.backgroundColor),e.trigger("input"))}})})})}}();